<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>For You</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@300;700&family=Dancing+Script:wght@700&display=swap');

        /* === ä¿®å¤1ï¼šæš´åŠ›å»é™¤å¾®ä¿¡è“æ¡†å’Œé•¿æŒ‰èœå• === */
        * {
            -webkit-tap-highlight-color: transparent !important; /* å¼ºåˆ¶å»è“æ¡† */
            -webkit-touch-callout: none; /* ç¦ç”¨é•¿æŒ‰å¼¹å‡ºèœå•(å¦‚ä¿å­˜å›¾ç‰‡) */
            -webkit-user-select: none; /* ç¦æ­¢é€‰ä¸­æ–‡å­— */
            user-select: none;
            outline: none;
        }

        /* å…è®¸è¾“å…¥æ¡†å¯ä»¥è¾“å…¥æ–‡å­— */
        input.wish-input {
            -webkit-user-select: auto !important;
            user-select: auto !important;
        }

        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            background-color: #050505;
            font-family: 'Noto Serif SC', serif;
        }

        ::-webkit-scrollbar { display: none; }

        #canvas-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
        }

        #intro-layer {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 10;
            text-align: center;
            transition: opacity 1s ease;
            pointer-events: none;
        }

        .pulse-dot {
            width: 12px;
            height: 12px;
            background-color: #fff;
            border-radius: 50%;
            margin: 0 auto 20px auto;
            box-shadow: 0 0 20px 5px rgba(255, 255, 255, 0.6);
            animation: pulse 2s infinite ease-in-out;
        }

        .hint-text {
            color: rgba(255, 255, 255, 0.6);
            font-size: 14px;
            letter-spacing: 2px;
            font-weight: 300;
        }

        #name-layer {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.8);
            z-index: 15;
            opacity: 0;
            text-align: center;
            transition: opacity 1s ease, transform 1.5s ease;
            pointer-events: none; 
            cursor: pointer;
        }

        #name-layer.visible {
            opacity: 1;
            transform: translate(-50%, -50%) scale(1);
            pointer-events: auto; 
        }

        .her-name {
            font-family: 'Dancing Script', cursive;
            font-size: 4rem;
            color: transparent;
            background: linear-gradient(to right, #ff9a9e, #fecfef, #a1c4fd);
            -webkit-background-clip: text;
            background-clip: text;
            text-shadow: 0 0 30px rgba(255, 192, 203, 0.5);
            margin: 0;
        }

        .subtitle {
            color: #fff;
            margin-top: 10px;
            font-size: 1.2rem;
            font-weight: 300;
            opacity: 0.8;
        }

        #wish-layer {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 20;
            text-align: center;
            opacity: 0;
            pointer-events: none;
            transition: all 0.8s ease;
            width: 80%;
            max-width: 400px;
            transform: translate(-50%, -40%);
        }

        #wish-layer.active {
            opacity: 1;
            pointer-events: auto;
            transform: translate(-50%, -50%);
        }

        input.wish-input {
            width: 100%;
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.3);
            border-radius: 30px;
            padding: 15px 20px;
            color: #fff;
            font-size: 16px;
            font-family: 'Noto Serif SC', serif;
            text-align: center;
            outline: none;
            backdrop-filter: blur(5px);
            margin-bottom: 20px;
            box-sizing: border-box; 
            transition: border-color 0.3s;
        }
        
        input.wish-input:focus {
            border-color: rgba(161, 196, 253, 0.8);
            background: rgba(255,255,255,0.1);
        }
        
        input.wish-input::placeholder {
            color: rgba(255,255,255,0.4);
            letter-spacing: 1px;
        }

        .submit-btn {
            background: linear-gradient(to right, #a1c4fd, #c2e9fb);
            border: none;
            padding: 12px 35px;
            color: #444;
            border-radius: 25px;
            font-family: 'Noto Serif SC', serif;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            letter-spacing: 2px;
        }
        .submit-btn:hover { 
            transform: scale(1.05);
            box-shadow: 0 0 15px rgba(161, 196, 253, 0.6);
        }

        #feedback-layer {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 25;
            width: 80%;
            text-align: center;
            color: #fff;
            opacity: 0;
            pointer-events: none;
            transition: opacity 1s ease;
            line-height: 2;
            font-weight: 300;
            font-size: 1.1rem;
            text-shadow: 0 0 10px rgba(161, 196, 253, 0.5);
            cursor: pointer;
        }
        
        #feedback-layer.active {
            opacity: 1;
            pointer-events: auto;
        }

        .modal {
            position: absolute;
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(8px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 12px;
            color: #fff;
            font-size: 0.9rem;
            pointer-events: none;
            opacity: 0;
            transform: scale(0.8);
            transition: all 0.3s ease;
            z-index: 20;
            white-space: nowrap;
        }
        .modal.active { opacity: 1; transform: scale(1); }

        @keyframes pulse {
            0% { transform: scale(1); opacity: 0.8; }
            50% { transform: scale(1.5); opacity: 0.4; }
            100% { transform: scale(1); opacity: 0.8; }
        }
    </style>
</head>
<body>

    <audio id="bgm" src="bgm.mp3" loop preload="auto" style="display:none;"></audio>

    <div id="canvas-container"></div>

    <div id="intro-layer">
        <div class="pulse-dot"></div>
        <div class="hint-text">é•¿æŒ‰å”¤é†’æ˜Ÿç³»</div>
    </div>

    <div id="name-layer">
        <h1 class="her-name">Happy Birthday</h1>
        <div class="subtitle">æ‰€å¿µçš†æ˜Ÿæ²³ï¼Œæ˜Ÿæ²³çš†æ˜¯ä½ </div>
    </div>

    <div id="wish-layer">
        <input type="text" class="wish-input" placeholder="åœ¨è¿™é‡Œå†™ä¸‹ä½ çš„æ„¿æœ›..." maxlength="30">
        <button class="submit-btn" onclick="submitWish()">å‘é€æ„¿æœ›</button>
    </div>

    <div id="feedback-layer" onclick="resetCycle()">
        <p>ä½ çš„å¿ƒæ„¿å·²å¯„å¾€äº¿ä¸‡å…‰å¹´å¤–çš„æ˜Ÿç³»ã€‚<br>å®ƒå°†ç©¿è¶Šæ¼«é•¿çš„æ—¶ç©ºï¼Œåœ¨æœªæ¥çš„æŸä¸€å¤©ï¼Œå¸¦ç€å®‡å®™çš„å›å“å¥”ä½ è€Œæ¥ã€‚</p>
        <div style="font-size: 12px; opacity: 0.5; margin-top: 20px;">( ç‚¹å‡»ä»»æ„å¤„è¿”å›æ˜Ÿç³» )</div>
    </div>

    <div id="bubble-modal" class="modal"></div>

    <script>
        // ================= é…ç½®åŒºåŸŸ =================
        const CONFIG = {
            name: "Alice", // è¿™é‡Œæ”¹æˆå¥¹çš„åå­—
            subtitle: "æ„¿æ‰€æœ‰çš„ç¾å¥½ï¼Œéƒ½æ°é€¢å…¶æ—¶", 
            wishes: [
                "ä»Šæ—¥ä»½çš„å¥½å¿ƒæƒ…æ­£åœ¨æ´¾é€ ğŸšš",
                "ç”Ÿæ´»æ˜æœ—ï¼Œä¸‡ç‰©å¯çˆ± ğŸŒ»",
                "æ„¿ä½ è‡ªåœ¨å¦‚é£ï¼Œå†…å¿ƒä¸°ç›ˆ ğŸƒ",
                "ä¿æŒçƒ­çˆ±ï¼Œå¥”èµ´å±±æµ· ğŸŒŠ",
                "åˆ«æ…Œï¼Œæœˆäº®ä¹Ÿæ­£åœ¨å¤§æµ·æŸå¤„è¿·èŒ« ğŸŒ™",
                "åšè‡ªå·±çš„å…‰ï¼Œä¸éœ€è¦å¤ªäº® âœ¨",
                "æ„¿ä½ è¢«è¿™ä¸ªä¸–ç•Œæ¸©æŸ”ä»¥å¾… ğŸ€",
                "å»å‘å…‰ï¼Œè€Œä¸æ˜¯è¢«ç…§äº® ğŸŒŸ",
                "æ…¢æ…¢ç†è§£ä¸–ç•Œï¼Œæ…¢æ…¢æ›´æ–°è‡ªå·± ğŸ§©",
                "å³ä½¿æ˜¯æ™®é€šçš„ä¸€å¤©ï¼Œä¹Ÿè¦é—ªé—ªå‘å…‰ ğŸŒ ",
                "ç¥ä½ å¿«ä¹ï¼Œä¸æ­¢ä»Šå¤© ğŸˆ",
                "æ‰€æœ‰çš„è¿æ°”ï¼Œéƒ½åœ¨è·¯ä¸Š ğŸ€",
                "æ„¿ä½ çœ¼è§’å¸¦ç¬‘ï¼Œæœˆè‰²ä¸æŸ“çœ‰æ¢¢ ğŸŒ™",
                "ä½ å€¼å¾—è¿™ä¸–é—´æ‰€æœ‰çš„æ¸©æŸ” â˜ï¸"
            ],
            colors: ["#ff9a9e", "#fecfef", "#a1c4fd", "#84fab0"]
        };
        
        document.querySelector('.her-name').textContent = CONFIG.name;
        document.querySelector('.subtitle').textContent = CONFIG.subtitle;
        const modal = document.getElementById('bubble-modal');

        let interactionMode = 0; 
        let state = 'IDLE'; 

        const canvas = document.createElement('canvas');
        const ctx = canvas.getContext('2d');
        document.getElementById('canvas-container').appendChild(canvas);
        let width, height;
        let particles = [];
        let bubbles = [];
        let musicPlayed = false;

        function initCanvas() {
            width = window.innerWidth;
            height = window.innerHeight;
            canvas.width = width;
            canvas.height = height;
        }
        window.addEventListener('resize', initCanvas);
        initCanvas();

        // ================= äº¤äº’æ§åˆ¶å™¨ =================
        const nameLayer = document.getElementById('name-layer');
        const wishLayer = document.getElementById('wish-layer');
        const feedbackLayer = document.getElementById('feedback-layer');

        nameLayer.addEventListener('click', () => {
            if (interactionMode === 0) {
                interactionMode = 1;
                nameLayer.style.transform
